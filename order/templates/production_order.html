{% extends 'base.html' %}

{% block title %}
  <title>生产管理</title>
{% endblock %}

{% block container %}

  <blockquote class="layui-elem-quote" style="display: flex; justify-content: space-between;">
    生产订单列表

    {% if request.session.user_power == 1 %}
    <a href="{% url 'order_mine' %}" style="display: flex; justify-content: flex-end;">我的所有订单</a>
    {% endif %}
  </blockquote>
{#  <div>#}
{#    <fieldset class="layui-elem-field">#}
{#      <legend>订单状态</legend>#}
{#      <div class="layui-field-box">#}
{#        <a class="layui-btn layui-btn-primary" href="{% url 'product_bl' %}">备料</a>#}
{#        <i class="layui-icon layui-icon-right"></i>#}
{#        <a class="layui-btn layui-btn-primary" href="{% url 'product_scz' %}">生产中</a>#}
{#        <i class="layui-icon layui-icon-right"></i>#}
{#        <a class="layui-btn layui-btn-primary" href="{% url 'product_dfh' %}">待发货</a>#}
{#        <i class="layui-icon layui-icon-right"></i>#}
{#        <a class="layui-btn" href="{% url 'product_ddwc' %}">订单完成</a>#}
{#        <a style="display: inline; float: right;" class="layui-btn layui-btn-normal" href="{% url 'product_all' %}">我的所有生产订单</a>#}
{#      </div>#}
{#    </fieldset>#}
{#  </div>#}

  <div>
    <table class="layui-table">
      <colgroup>
        <col width="15%">
        <col width="20%">
        <col width="">
        <col width="5%">
        <col width="6%">
        <col width="6%">
        <col width="6%">
        <col width="6%">
        <col width="5%">
      </colgroup>
      <thead>
      <tr>
{#        <th>订单编号</th>#}
        <th>客户名称</th>
        <th>产品型号</th>
        <th>料号信息</th>
        <th>数量</th>
        <th>业务人员</th>
        <th>创建时间</th>
        <th>发货时间</th>
        <th>生产进度</th>
        <th>操作</th>
      </tr>
      </thead>
      <tbody>
      {% for order in order_list %}
      <tr>
{#        <td>{{ order.sn }}</td>#}
        <td>{{ order.customer }}</td>
        <td>{{ order.good }}</td>
        <td>{{ order.remark }}</td>
        <td>{{ order.sumnumber }}</td>
        <td>{{ order.salesperson }}</td>
        <td>{{ order.created_time|slice:"5:" }}</td>
        <td>{{ order.deliver_time|slice:"5:"|default_if_none:'' }}</td>
        <td>
          {% if order.is_deliver == 0 %}
          <a class="layui-btn-sm layui-btn layui-btn-primary" href="javascript:;">
            生产中
          </a>
          {% elif order.is_deliver == 1 %}
          <a class="layui-btn-sm layui-btn layui-btn-primary" href="javascript:;">
            已发货
          </a>
          {% endif %}
        </td>
        <td><a class="layui-btn layui-btn-danger layui-btn-sm"
               onclick="return deleteOrder();" href="{% url 'order_del' order.id %}">删除</a></td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  {% if page_obj %}
    {% if page_obj.has_previous %}
      <a class="layui-btn layui-btn-normal layui-btn-sm" href="?page={{ page_obj.previous_page_number }}">上一页</a>
    {% endif %}
    <a class="layui-btn layui-btn-primary layui-btn-sm" href="javascript:;">当前页 {{ page_obj.number }} 共 {{ paginator.num_pages }} 页.</a>
    {% if page_obj.has_next %}
      <a class="layui-btn layui-btn-normal layui-btn-sm" href="?page={{ page_obj.next_page_number }}">下一页</a>
    {% endif %}
  {% endif %}
{% endblock %}

{% block footer %}
  <script type="text/javascript" language="JavaScript">
      function deleteOrder() {
          if (confirm("确定要删除该订单信息吗？")) {
              return true;
          } else {
              return false;
          }
      }
  </script>
{% endblock %}